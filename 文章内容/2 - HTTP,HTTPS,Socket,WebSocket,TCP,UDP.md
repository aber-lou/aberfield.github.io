---
layout: mypost
title: HTTP,HTTPS,Socket,WebSocket,TCP,UDP。
---

# 《HTTP 权威指南》

### 一、HTTP、Web基础

+ HTTP传输过程中的媒体类型 MIME,用来标识主要的对象类型和一个特定的子类型，下面列出简单的四个，其实MIME类型还有很多种:
    1. text/html： Html格式的文本。
    2. text/plain: 普通的ASCII 文本。
    3. image/jpeg: JPEG格式图片。
    4. image/gif: Gif格式图片。

+ URI: （Uniform Resource Identity，URI），统一资源标识符。URI有两种类型，分别是URL，URN。现阶段几乎所有的URI都是URL。

+ URL：（Uniform Resource Location，URL）,统一资源定位符。包含三部分：
    1. 第一部分为 scheme,如 http://
    2. 第二部分为 服务器地址 如 www.bluestonehk.com.
    3. 第三部分 为web服务器上面的资源。 如 /index.html。

+ URN: 统一资源名，URN 是作为特定内容的唯一名称使用的，和资源所在地无关。 处于实验阶段。

+ 一些常见的HTTP方法：
    + GET: 从服务器获取一份文档
    + PUT: 将来自客户端的数据存储到一个命名的服务器资源中，将请求的主题部分存储到服务器上
    + DELETE: 从服务器中删除资源
    + POST: 将客户端需要处理的数据发送到一个服务器
    + HEAD: 仅发送命名资源相应中的HTTP首部，或者从服务器获取文档的首部
    + TRACE: 对可能经过代理服务器传送到服务器上去的报文进行追踪
    + OPTIONS: 决定可以在服务器上执行什么方法

+ 状态码，每条HTTP相应报文都会携带一个状态码。状态码是一个三位数字的代码，告知客户端请求是否成功，或者采取了其他动作。
    + 100 ~ 199， 已定义范围 100 ~ 101  信息提示
    + 200 ~ 299， 已定义范围 200 ~ 206  成功
    + 300 ~ 399， 已定义范围 300 ~ 305  重定向
    + 400 ~ 499， 已定义范围 400 ~ 415  客户端错误
    + 500 ~ 599， 已定义范围 500 ~ 505  服务端错误

+ 报文，HTTP报文都是纯文本，不是二进制代码。

+ 连接，HTTP是个应用层协议，HTTP无需操心网络通信细节，把联网细节都交给了通用可靠的传输层协议 TCP/IP协议。 ``` 这里可以联想一下OSI七层协议 ```。

    + TCP提供了：
        1. 无差错的数据传输。
        2. 按序传输。
        3. 未分段的数据流。

    + 连接、IP地址以及端口号、DNS(域名服务)
        
        1. 连接中可以 找到 IP地址 以及端口号，
        2. URL没有使用数字形式的IP地址，以文本显示，可以通过DNS(域名服务)转化为IP地址。
        3. URL没有指明端口号的话，会使用默认端口号，假设为80

    + 整个连接流程： 
        
        1. 浏览器从URL中解析出服务器主机名。
        2. 浏览器将服务器主机名转化成服务器IP地址。
        3. 浏览器将端口号从URL中解析出来，如果没有则使用默认端口号。
        4. 浏览器建立一条Web服务器的TCP连接。
        5. 浏览器想服务器发送一条HTTP请求报文。
        6. 服务器向浏览器回送一条HTTP相应报文。
        7. 可能关闭连接，浏览器显示内容，这里可能会存在kept-alive等。

+ HTTP协议版本，现在HTTP协议版本用的稍微广泛的是HTTP1.1版本，当然HTTP/2也开始慢慢普及起来，具体对比可以看这个链接
[HTTP/2的时代来了](https://blog.csdn.net/g6U8W7p06dCO99fQ3/article/details/78906348)，[HTTP/2协议规范](https://blog.csdn.net/u010129119/article/details/79361949#2-http2-%E5%8D%8F%E8%AE%AE%E6%A6%82%E8%BF%B0)。
    
    + HTTP 1.0 一次请求-响应，用完关闭；每一个请求都要建立一个连接，keep-alive早期实验性持久连接(主要是涉及中间多层哑代理会引发很大的问题)。

    + HTTP 1.1 Pipeling解决方式：若干个请求排队串行单线程处理，后面的请求等待前面的返回才能获得执行机会，一旦有请求超时等，后续请求只能被阻塞。 相比于1.0 的升级有 缓存处理，带宽优化以及网络连接的使用，错误通知的管理，Host头处理，持久连接(Persistent connection)。

    + HTTP 2.0 二进制分帧，多路复用，请求优先级，Header头部压缩，服务端推送，并且向下兼容 HTTP 1.1。可以节省带宽、降低TCP链接次数、节省CPU，帮助移动设备延长电池寿命等。

+ Web的结构组件
    
    + 代理：位于客户端和服务器之间的中间实体，对请求和响应进行过滤，病毒检测，内容合法性检测。

    + 缓存：HTTP的仓库，使常用页面的副本可以保存在离客户端更近的地方，Web Cache 或者 Proxy Cache。比如将文档保存到代理中，下次别连接的请求这份文档可以直接把代理缓存的内容丢过去。

    + 网关：连接其他应用程序的特许Web服务器，特殊服务器，作为其他服务器的中间实体，通常用于将HTTP流量转化成其他协议。

    + 隧道：对HTTP通信报文进行盲转发的特殊代理，常见用户通过HTTP连接承载加密的安全套接字（SSL）流量。

    + Agent代理：发起自动HTTP请求的半智能Web客户端，面向客户端，本地化，统一收集信息，处理转化消息，发送至Server更新本地状态。

### 二、URL与资源

+ URL语法：大多数URL方案的语法建立这个由9个部分的通用格式上：
    ```
        <scheme>://<user>:<password>@<host>:<port>/<path>;<param>?<query>#<frag>
    ```

+ URL编码机制，将一些字符串转义，表示法中包含一个%，后面跟着两个表示符ASCII码的十六进制。
    
    + 字符限制：Url中有几个字符是被保留起来的，比如%，/,.等等。

+ 常见的URL方案格式
    
    1. http: 超文本传输协议，没有用户名和密码，其他和通用的的URL格式相符。默认端口号为 80。

    2. https：和http方案一直，唯一的区别在Https使用了SSL，提供了端到端加密机制。默认端口为443。

    3. mailto：E-mail地址，和标准的URL格式有所不通，这里不深入探讨。

    4. ftp；文本传输协议，可以通过URL上传下载文件。

    5. rtsp，stspu：是可以通过实时流传输协议解析音视频媒体资源标识符。其中Rtspu代表通过UDP来获取资源。

    6. file：表示一台指定主机，可以通过磁盘，网络文件系统或一些其他文件系统共享内容。

    7. news 根据RFC 1036定义，方案news用来访问一些特定的文章或者新闻组。

    8. Telnet 用于访问交互式业务。

### 三、HTTP报文

+ HTTP报文，是在HTTP应用程序之间发送的数据块。这些数据以一些文本形式的元信息开头。

    + 报文流入源端服务器

    + 报文向下游流动

+ HTTP报文的组成部分，三个部分组成：起始行（start line），头部（header），数据主体（body）。

    + 所有的HTTP报文都分为两类，请求报文，响应报文。

        1. 方法： 客户端希望服务器对资源执行的动作，如GET，POST，HEAD，PUT等。
            
            1. HTTP定义了一组安全方法，Get、Head，这一组方法的HTTP请求不会产生什么动作。

        2. 请求URL：命名了所有的请求资源。

        3. 版本：报文所使用的HTTP版本

        4. 状态码（Status Code） ，请求过程中的状态，成功，出错，重定向等

        5. 原因短语， 请求状态提示原因

        6. 首部

        7. 实体部分

    + 请求行：请求报文的起始行，包含该一个方法和一个请求URL。这个方法包含了服务的应该需要执行的操作，请求URL描述了要怼哪个资源执行这个方法，请求行还包括HTTP的版本，空格分割。

    + 响应行：承载了状态信息和操作产生的所有结构数据，将其返回给客户端。

    + 方法：除了之前描述过得方法(Get,Post,Delete)之外，服务器本身也可以自定义一些方法，称之为扩展方法。

    + 状态码： 在文章之前也有描述。常见的状态码 
        
        1.   200  OK  成功，请求的所有数据都在响应主体中
        2.   401  Unauthorized  未授权  需要输入用户名和密码
        3.   403  Forbidden     被拒绝，服务器拒绝了你的访问
        4.   404  Not Found    服务器没有找到所请求的URl资源。
        5.   100  Continue     说明服务端收到了请求的初始部分，客户端需要继续发送
        6.   408  Request Timeout  如果客户端完成请求所花时间太长，服务器可以回送次状态码，并关闭连接。
        7.   500  Internal Server Error 服务器遇到一个错误
        8.   501  Not Implemented   客户端请求超出了服务器范围，如使用了服务器不支持的方法等。
        9.   502  Bad Gatewa        错误网关

    + 版本号 HTTP / 2， 请求所使用的版本号，其中需要注意的是  HTTP / 2.22 是根据.前后两个数来决定的，所以2.22 版本其实是2版本22小版本，会比2.3 版本更高级。


+ 首部：通用首部，请求首部，响应首部，实体首部，扩展首部。

+ 方法：

    1. TRACE主要用于争端，也就是，验证请求是否如愿的穿过了请求、响应链。

    2. OPTIONS方法请求Web服务器告知其支持的各种功能。可以询问服务器通常支持的哪些方法。
    
    3. Delete：请求服务器，并且删除URL所指定的资源。HTTP规范允许在不通知客户端的情况撤销请求。

+ 状态码： 【HTTP权威】第3.4节有详细说明。


### 四、连接管理

+ TCP连接：几乎所有的HTTP通信都是由TCP/IP承载的。
    + TCP为HTTP提供了一条可靠传送管道

    + TCP流是分段的，由IP分组传送，HTTPS其实就是HTTP和TCP之间插入了一个TLS/SSL的密码加密层。

    +  保持TCP连接的正确运行

+ 对TCP性能的考虑

   + HTTP事务的时延
        1. 客户端需要根据URI确定Web服务器的IP地址和端口号，解析寻址可能会需要一些时间，特别是最近没有访问的连接。

        2. 发起连接，客户端会发送一条TCP连接请求，等待服务器回送请求接受应答，每条新的TCP都会有建立连接时延。

        3. 一旦连接建立起来，客户端会通过新建立的TCP管道来发送HTTP请求，数据到达时，会Web服务器会从TCP连接中读取请求报文，并对请求进行处理。

        4. Web服务器会送HTTP响应。

    + 性能聚焦区域

        1. TCP连接建立握手
        2. TCP慢启动拥塞控制
        3. 数据聚集Nagle算法
        4. 用于捎带确认的TCP延迟确认算法
        5. Time_Wait时延和端口耗尽

    + [TCP拥塞控制-慢启动，拥塞避免，快重传，快启动](https://blog.csdn.net/jtracydy/article/details/52366461)

    + TCP握手时延迟，三次握手
        1. 客户端向服务器发送小的TCP分组，设置特殊的SYN标记，说明连接请求
        2. 服务端接受连接，对连接参数进行处理，返回一个TCP分组，包含SYN和ACK标志位
        3. 客户端再向服务器发送一条确认信息

    + 延迟确认：TCP连接很大可能会出现丢包情况，所以每个TCP段都有一个序列号和数据完整性校验和。接收收到后，都会像发送者会送小的确认分组。如果发送者未能收到确认信息，发送者就认为已丢包，并重发数据。

    + TCP慢启动：TCP数据传输性能还取决于TCP连接的使用期。TCP连接会随着时间进行自我调整，慢慢增加连接时的最大速度，如刚连上一次只能发送一个分组，发送成功并收到确认时，就新增了发送另外两个分组的权限。  这种处理方式称之为‘打开拥塞窗口’。慢启动主要的作用是防止连接成功后大量数据注入网络中，可能会导致网络拥塞，慢启动相当于慢慢试探网络情况，每一次数据交换后，增加拥塞窗口大小。

    + Nagle算法和TCP_NoDelay：Nagle算法主要是发送分组数据前，尽可能将TCP数据绑定在一起，提高网络速率，但是如果一直有小分组的TCP数据组时，会严重影响性能，所以可以设置TCP_NoDelay,禁用Nagle算法。保证在TCP写入大块数据时，才使用Nagle算法。

    + Time_Wait累积和端口耗尽，当TCP端点关闭TCP连接时，会在内存中维护一个小的控制块，用来记录最近所关闭连续的IP地址和端口号，可以防止短时间内创建，关闭并重新创建相同的IP地址和端口连接。

+ HTTP连接处理
    
    + 常被误解的Connection首部

    + 串行事务处理时延

    + 并行连接
        
        1. 并行连接可能可以提高页面的加载速度，但是并不一定块，因为客户端网络资源不足时，并行就涉及到了多个连接去竞争有限的网络资源，同时也会导致服务端连接数太多，有可能会导致端口耗尽，而需等待，连接不上的情况。 

    + 持久连接

        1. HTTP/1.0  + Keep - alive连接

        2. 在存在哑代理情况下会导致连接无法断开

        3. 即使使用Proxy-connection也无法在多个代理之间有效使用keep-alive

        4. HTTP/ 1.1 + persistent connection 持久连接

    + 管道化连接

    + 连接关闭，重试，幂等性
    
        + 幂等，GET、HEAD、PUT、DELETE、TRACE、OPTIONS 这几个HTTP Method共享这一特性。

    + 正常关闭连接

        + 正常关闭和半关闭

        + TCP关闭和重置错误

        + 正常关闭

### 五、web服务器

+  Web服务器的作用

    1. 接受客户端连接

        + 处理新连接，Web服务建立连接，Web服务器可以随意拒绝和立即关闭任意一条连接。

        + 客户端主机名识别

        + 通过Ident确定客户端用户，服务器建立了HTTP连接通道之后，可以请求和客户端建立一天Ident通道，用来确认客户端信息。

    2. 接受请求报文
            
        + 报文内部标识法

        + 连接的输入、输出处理结构

    3. 处理请求：根据方法，资源，首部，可选的主题部分对请求进行处理。

    4. 对资源的映射以及访问
            
        + DocRoot，Web服务器文件体系会有一个专门用于存放Web内容。

        + 根据Url解析目录列表，处理对应内容

        + 动态内容资源映射

        + 访问控制

    5. 构建响应

        + 响应实体

        + MIME类型

        + 重定向

             - 永久删除资源，状态码 301 处理此类情况

             - 临时删除资源，状态码 303、307 标识此类情况
             
             - URL增强， 状态码303、307 标识此类情况

             - 负载均衡，如上

             - 服务器关联

             - 规范目录名称

    6. 发送响应：服务器记录连接状态，特别是对持久连接的处理，对于非持久连接，服务器发送完报文之后可以关闭服务端连接

    7. 记录日志：事务结束之后，Web服务器中添加一个条目，描述已执行事务。

### 六、代理

+ 私有和共享代理

    - 公共代理：集中式代理效率高，更容易管理，可以利用用户间共同请求，同一代理服务器的用户越多，越有用

    - 私有代理：不常见，一般是直接运行在客户端计算机，如一些ISP服务。

+ 代理和网关的对比

    - 代理是连接两个多多个相同协议的应用程序

    - 而网关连接的是两个或者多个不同协议的断点，主要作用是可以做协议转换。

+ 为什么使用代理

    - 访问控制：对不同层次用户进行访问控制

    - 安全防火墙：提高安全性，在代理中可以对流量进行检查

    - Web缓存：代理缓存维护常用文档副本，按需提供，直接代理充当服务器进行响应并返回

    - 反向代理：代理充当服务器加速器，直接收发服务器真实请求，也可以和其他服务器进行通信，按需定位所请求内容

    - 内容路由器：根据请求状况以及内容类型将请求导向特定的Web服务器

    - 转码器：修改请求内容，如传输JPEG图片时，可以对其进行压缩什么的

    - 私密访问：删除身份特性，进行匿名访问

+ 代理服务器的部署

    - 出口代理：固定在本地网络的出口，控制本地网络和互联网之间流量

    - 入口代理：常被放在ISP访问点上，处理用户的 聚合请求，缓存常用文档，提高用户下载速度。

    - 反向代理：部署在Web服务器之前，处理所有请求，在必要情况下采取请求服务器资源

    - 网络交换代理：放在网络之间的对等交换点上，通过缓存来减轻网络拥塞，进行流量监视

+ 代理的层次结构

    - 代理层次结构变化可以用于一下功能

        + 负载均衡，根据当前内容负载，来选择下一级代理

        + 地理位置附近的路由，选择负载原始服务器所在物理区域的代理

        + 协议、类型路由 根据特殊代理服务器的请求，一遍进行特殊协议处理

        + 基于订购路由转发

+ 代理是如何获取流量的

    - 修改客户端，手动代理设置

    - 修改网络，拦截网络流量，导入代理。

    - 根据DNS导向获取

    - 修改Web服务器，进行重定向

+ 代理请求中有关的一些棘手问题

    - 代理请求URI与服务器URI的不同:
        
        + 向代理发送请求时，必须是完整的URL路径，而向服务器发送请求无需发送全部的URL连接。

    - 代理既可以处理代理请求，也可以处理服务器请求

    - 代理转发过程中对URI的修改

+ 代理认证

    - 代理可以作为访问控制设备使用。HTTP定义了一种名为代理认证的机制，可以阻止对内容的请求，知道用户向代理提供了有效的访问权限为止。

        + 对受限内容的请求到达一台代理服务器时，代理服务器可以返回一个要求使用访问证书407状态码。

        + 客户端收到407响应，客户端重新发送请求，在Proxy-Authorization首部提供证书。

+ 代理的互操作性

    - 客户端服务器和代理是由不同厂商构建的，实现的是不同版本的HTTP规范，他们支持的特性各不相同，也存在着不同的问题。代理服务器位于客户端和服务器设备之间。

### 七、缓存

+ Web缓存是自动保存常见文档副本的HTTP设备，当Web请求抵达缓存时，如果本地有“已缓存”的副本，就可以直接从本地存储设备而不是服务器提取这个文档了。使用缓存的有点:

    1. 缓存减少了冗余的数据传输，节省网络流量
    2. 缓存缓解了网络瓶颈的问题，不需要更多的带宽就能更快的加载页面
    3. 缓存降低了对原始服务器的要求，服务器可以更快的响应，避免过载的出现   
    4. 缓存降低了距离时延，从较远的地方加载页面会更慢一点，中间可能经过多级代理。

+ 冗余的数据传输
    
    - 相同内容服务器可能需要给每一个请求端重复发送，缓存可以保留第一条服务器副本，后继请求直接用缓存副本来应对，减少冗余数据传输。

+ 带宽瓶颈

    - 缓存可以缓解网络瓶颈问题，客户端可以直接从快速局域网的缓存中提取一份副本，不去麻烦服务端，而服务端可以抽出更多时间去处理其他问题。

+ 瞬间拥塞

    - 突然大流量访问同一份文档时，会导致服务器处理不过来，而缓存正好可以解决这种问题。

+ 距离时延:远距离请求服务器内容，中间会存在距离时延，但是如果请求附近内容缓存则可以避免距离时延问题。

+ 命中和未命中:缓存不能保存每一份副本，如果未命中的情况还是需要请求服务器重新获取资源

+ 再验证:原始服务器资源可能已发生改变，在请求命中缓存的时候会根据HTTP新鲜度检测规则对资源进行再验证，验证是否最新的内容。

    - 缓存对缓存的副本进行验证时，会向服务器发送一个小的在验证请求。如果服务器资源没有发生改变，服务器会以一个小的304Not Modified进行响应。只要缓存知道副本仍然有效，就会将缓存标记为暂时最新，这种叫做再验证命中或者缓慢命中。

+ 命中率、字节命中率:因为有些大型对象被访问的字数比较少，但是由于尺寸问题，对整个数据流量贡献却最大，因此有人更愿意使用字节命中率。

+ 区分缓存命中和未命中的情况:客户端可以根据Date首部，将相应中的Date首部的值和当前时间进行比较，如果相应中的日期值比较早，客户端通常认为这是一条缓存的相应。

+ 缓存的拓扑结构
    
    - 缓存可以是单个用户使用，也可以是全部用户共享。专用缓存称之为私有缓存，其他为公有缓存。

    - 私有缓存：大多数流浪器将常用的文档缓存到个人电脑的磁盘和内存中，并且允许用户去设置缓存的大小以及其他设置。

    - 公有缓存：是特殊的共享代理服务器，为缓存代理服务器。

+ 代理缓存的层次结构

    - 在实际中，实现层次化的缓存是由意义的，在这种结构中缓存未命中的请求会被导向较大的父缓存。一般可以是由几级缓存，在靠近客户端一方第一级缓存，用于命中一些请求，为命中请求继续去第二季缓存区适配命中缓存内容。

+ 网状缓存，内容路由以及对等缓存

    - 有些网络结构会构建复杂的网状缓存，而不是简单的缓存层次结构。

        + 根据URL在父缓存或原始服务器之间进行动态选择

        + 根据URL动态选择一个特定的父缓存

        + 前往父缓存之前，在本地缓存中搜索已缓存的副本

        + 允许其他缓存对其缓存的部分内容进行访问，但是不允许流量通过其缓存

+ 缓存的处理步鄹

    1. 接受，缓存从网络中读取抵达的请求报文
    2. 解析，缓存对报文进行解析，提取出URL和各种资源
    3. 查询，缓存查看是否有本地副本可用，如果没有，就获取一份副本
    4. 新鲜度检测，缓存查看已缓存副本是否是最新的，如果不是，询问服务器是否有更新
    5. 创建响应，缓存会用新的首部和已缓存的主题来构建一条响应报文
    6. 发送，缓存通过网络将响应发回给客户端
    7. 日志，缓存可选的创建一个日志文件来描述这个事务

    + 缓存Get请求流程图

    ![cache](https://raw.githubusercontent.com/aberfield/aberfield.github.io/master/posts/network.png)


    + 用条件方法进行再验证

        1. HTTP定义了五个条件请求首部，对缓存在验证的两个首部是：```if-modifield-since```,```if-none-match```。

    + 强弱验证器：HTTP/1.1支持“弱验证器”,对一些非实质性或者不重要的修改时，不要使得所有已缓存副本都失效，允许服务器声明足够好的等价体。

+ 如何控制缓存

    - no-Store、no-Cache首部:防止缓存提供未经证实的已缓存对象。

    - max-age：表示从服务器将文档传来之时起，可以认为此文档处于最新状态的秒数```Cache-Control: max-age=3600```

    - expires:实际过期时间

    - must-revalidate：表明在没有和服务器未进行再验证的情况，不能提供这个对象的陈旧副本。

    - 试探性过期：LM-Factor算法是一个常用的试探性过期算法：

        1. 如果文档最后一次修改发送在很久以前，它可能是一分稳定的文档，不太会突然发生变化，因此可以继续保存

        2. 如果缓存文档最近有更新过，说明它可能有频繁变化，因此在于服务器进行再验证之前，只能将其缓存很短一段时间

    - 客户端新鲜度限制：客户端可以进行刷新或者重载，强制刷新不采用缓存内容进行刷新。

+ 设置缓存控制，不同的Web服务器为HTTP Cache-Control 和Expiration首部的设置提供了一些不同的机制。

+ 缓存新鲜度算法

    - 为了分辨缓存文档是否足够新鲜，缓存一般计算两个值，已缓存副本的使用期A，已缓存副本的新鲜生存期F，如果F小于A说明副本足够新鲜。

    - 使用期的计算： 表面使用期是基于Date首部处理 ， 逐跳使用期的计算  ， 对网络时延的补偿      

    - 完整的试用期计算算法

    - 新鲜生存期的计算

+ 缓存和广告

    - 发布广告者的两难处境：有些内容可能直接通过缓存返回，无法拿到有效的访问量，所以可能会导致利益损失

    - 发布者的响应：广告内容可以通过 Header 中加上"no-cache"来清除缓存。当然还有一种是配置缓存，每次访问都于原始服务器进行再验证，这样每次访问时都会将命中推向原始服务器。

    - 日志迁移：再验证的情况也会影响性能，导致多余的性能消耗，所以可以通过缓存将命中日志发送到服务器也行，实际上，有些大型缓存的提供商已经对缓存日志进行处理，并将其发送给受影响的内容提供商。

    - 命中计数和使用频率，这个协议向HTTP中添加了一个称为Meter的首部，这个首部会周期性的对特定的URL命中次数回送给服务器，通过这种方式，服务器可以从缓存周期性的获取对已缓存文档命中次数的更新。


###  八、集成点：网关，隧道、中继

+ 主要讨论的几个点：

    1. 在HTTP和其他协议以及应用程序之间起到接口作用的网关

    2. 允许不同类型的Web应用程序互相通信的应用程序接口

    3. 允许用户在HTTP连接上发送非HTTP流量的隧道

    4. 作为一种简化的HTTP代理，一次将数据转发一跳的中继


+ 网关：是资源和应用程序之间的粘合剂，可以提供一条响应，可以向数据库发送查询语句，生成动态内容，有些网关可以将HTTP协议转换为其他协议，这样HTTP客户端就无需了解其他协议了。

    - 客户端网关：通过其他协议与客户端通信，通过HTTP与服务端通信

    - 服务端网关：通过HTTP与客户端对话，通过其他协议与服务器通信

+ 协议网关

    - 协议网关：可以将客户端的HTTP请求转化成为其他协议。

    - HTTP/HTTPS：服务端安全网关

    - HTTPS/HTTP：客户端安全加速网关

+ 资源网关

    - CGI：通用网关接口：CGI是一个标志的接口集，Web服务器用它来转载程序以响应对特定的URL的HTTP请求，并收集程序的输出数据。

    - 服务器扩展API：CGI协议为外部翻译器与现有的HTTP服务器提供了一种简洁的接口方式

+ SSL隧道


+ 中继
    
    - 盲中继


### 九、Web机器人

+ 爬虫以及爬行方式

    1. 从根基开始
    2. 链接的提取以及相对链接的标准化
    3. 避免环路
    4. 循环和复制
    5. 面包屑留下的痕迹

        - 大规模爬虫对齐访问地址使用到的一些有用的技术
            1. 树和散列表
            2. 有损的存在位图
            3. 检查点
            4. 分类
    6. 别名和机器人环路
    7. 规范化URL
    8. 文件系统连接环路
    9. 动态虚拟Web空间
    10. 避免循环与重复

        - 规范化URL
        - 广度优先的爬行
        - 节流
        - 限制URL的大小
        - URL/站点黑名单
        - 模式检测
        - 内容指纹
        - 人工监视
    
+ 爬虫的HTTP

    1. 识别请求首部
    2. 虚拟主机
    3. 条件请求
    4. 对响应的处理
    5. User-agent导向

+ 行为不当的爬虫

+ 拒绝爬虫访问
    
    - 拒绝爬虫的访问标准

    - Web站点和robots.txt文件

    - robots.txt文件的格式

    - 其他关于robots.txt的只是

    - 缓存和robots.txt的过期

    - 拒绝爬虫访问的Perl代码

    - HTML的robot-control标签

+ 爬虫规范

+ 搜索引擎

    - 大格局

    - 现代搜索引擎结构

    - 全文索引

    - 发布查询请求

    - 对结果进行排序，并提供查询结果

    - 欺诈

### HTTP-NG 下一代HTTP规范

+ HTTP发展中存在的问题

    + 复杂性

    + 可扩展性

    + 性能

    + 传输依赖性

+ HTTP-NG的活动

+ 模块化以及功能增强

    + HTTP-NG的工作组分为三层，

        1. 报文传输层

        2. 远程调用层

        3. Web应用层

+ 分布式对象

+ 第一层：报文传输

+ 第二层：远程调用

+ 第三层：Web调用

+ WebMuX标准

+ 二进制连接协议

### 客户端识别与Cookie机制

+ 个性化接触

+ 


    















































